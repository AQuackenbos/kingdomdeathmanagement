(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["settlement"],{"13d5":function(t,e,a){"use strict";var s=a("23e7"),i=a("d58f").left,n=a("a640"),c=a("ae40"),r=a("2d00"),o=a("605d"),l=n("reduce"),d=c("reduce",{1:0}),u=!o&&r>79&&r<83;s({target:"Array",proto:!0,forced:!l||!d||u},{reduce:function(t){return i(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},2532:function(t,e,a){"use strict";var s=a("23e7"),i=a("5a34"),n=a("1d80"),c=a("ab13");s({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~String(n(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"461b":function(t,e,a){},"5a34":function(t,e,a){var s=a("44e7");t.exports=function(t){if(s(t))throw TypeError("The method doesn't accept regular expressions");return t}},"7db0":function(t,e,a){"use strict";var s=a("23e7"),i=a("b727").find,n=a("44d2"),c=a("ae40"),r="find",o=!0,l=c(r);r in[]&&Array(1)[r]((function(){o=!1})),s({target:"Array",proto:!0,forced:o||!l},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(r)},"99af":function(t,e,a){"use strict";var s=a("23e7"),i=a("d039"),n=a("e8b5"),c=a("861d"),r=a("7b0b"),o=a("50c4"),l=a("8418"),d=a("65f0"),u=a("1dde"),v=a("b622"),p=a("2d00"),h=v("isConcatSpreadable"),m=9007199254740991,f="Maximum allowed index exceeded",b=p>=51||!i((function(){var t=[];return t[h]=!1,t.concat()[0]!==t})),_=u("concat"),g=function(t){if(!c(t))return!1;var e=t[h];return void 0!==e?!!e:n(t)},C=!b||!_;s({target:"Array",proto:!0,forced:C},{concat:function(t){var e,a,s,i,n,c=r(this),u=d(c,0),v=0;for(e=-1,s=arguments.length;e<s;e++)if(n=-1===e?c:arguments[e],g(n)){if(i=o(n.length),v+i>m)throw TypeError(f);for(a=0;a<i;a++,v++)a in n&&l(u,v,n[a])}else{if(v>=m)throw TypeError(f);l(u,v++,n)}return u.length=v,u}})},ab13:function(t,e,a){var s=a("b622"),i=s("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[i]=!1,"/./"[t](e)}catch(s){}}return!1}},d58f:function(t,e,a){var s=a("1c0b"),i=a("7b0b"),n=a("44ad"),c=a("50c4"),r=function(t){return function(e,a,r,o){s(a);var l=i(e),d=n(l),u=c(l.length),v=t?u-1:0,p=t?-1:1;if(r<2)while(1){if(v in d){o=d[v],v+=p;break}if(v+=p,t?v<0:u<=v)throw TypeError("Reduce of empty array with no initial value")}for(;t?v>=0:u>v;v+=p)v in d&&(o=a(o,d[v],v,l));return o}};t.exports={left:r(!1),right:r(!0)}},e555:function(t,e,a){"use strict";a("461b")},e8ea:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return!t.showLoading&&t.user&&t.campaign?a("div",{staticClass:"column"},[a("h1",{staticClass:"title can-update",on:{mouseover:function(e){t.showTitleEdit=!0},mouseleave:function(e){t.showTitleEdit=!1}}},[t._v(" "+t._s(t.campaign.name)+" "),t.showTitleEdit?a("span",{staticClass:"is-size-6",on:{click:t.updateTitle}},[a("b-icon",{staticClass:"is-clickable ml-2",attrs:{size:"is-small",icon:"edit"}})],1):t._e()]),a("h2",{staticClass:"subtitle"},[t._v("Lantern Year "+t._s(t.campaign.year))]),a("div",{staticClass:"columns is-multiline"},[a("div",{staticClass:"column is-3"},[a("div",{staticClass:"card"},[t._m(0),a("div",{staticClass:"card-content"},[a("div",{staticClass:"block"},[a("ul",[t._l(t.members,(function(e){return a("li",{key:e.uid},[t._v(t._s(e.displayName))])})),a("li",[a("b-button",{attrs:{type:"is-info",size:"is-small","icon-left":"user-plus"},on:{click:function(e){t.showAddUser=!0}}},[t._v("Invite Player")])],1)],2),a("b-modal",{attrs:{"has-modal-card":"","trap-focus":"","destroy-on-hide":!1,"aria-role":"dialog","aria-modal":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("UserAdd",{on:{close:e.close,add:t.addUser}})]}}],null,!1,178145595),model:{value:t.showAddUser,callback:function(e){t.showAddUser=e},expression:"showAddUser"}})],1)])])]),a("div",{staticClass:"column is-3"},[a("div",{staticClass:"card"},[t._m(1),a("div",{staticClass:"card-content"},[a("div",{staticClass:"block"},[a("h1",{staticClass:"subtitle"},[t._v("Limit")]),a("h2",{staticClass:"title can-update max-survival",on:{click:t.updateSurvival}},[t._v(t._s(t.campaign.survival.max))]),a("p",{staticClass:"has-text-size-7 is-size-7",staticStyle:{color:"#aaa","margin-bottom":".25em"}},[t._v("(+"+t._s(t.maxSurvivalBonus)+" from Innovations)")]),a("h1",{staticClass:"subtitle"},[t._v("Departing")]),a("h2",{staticClass:"title"},[t._v(t._s(t.departingSurvival))])])])])]),a("div",{staticClass:"column is-3"},[a("div",{staticClass:"card"},[t._m(2),a("div",{staticClass:"card-content"},[a("div",{staticClass:"block"},[a("ul",[t._l(t.campaignQuarries,(function(e){return a("li",{key:e.id},[t._v(t._s(e.name))])})),a("li",[a("b-button",{attrs:{type:"is-info",size:"is-small","icon-left":"folder-plus"},on:{click:function(e){t.showAddQuarry=!0}}},[t._v("Add Quarry")])],1)],2),a("b-modal",{attrs:{"has-modal-card":"","trap-focus":"","destroy-on-hide":!1,"aria-role":"dialog","aria-modal":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("QuarryAdd",{on:{close:e.close,add:t.addQuarry}})]}}],null,!1,1600501147),model:{value:t.showAddQuarry,callback:function(e){t.showAddQuarry=e},expression:"showAddQuarry"}})],1)])])]),a("div",{staticClass:"column is-3"},[a("div",{staticClass:"card"},[t._m(3),a("div",{staticClass:"card-content"},[a("div",{staticClass:"block"},[a("ul",[t._l(t.campaignLocations,(function(e){return a("li",{key:e.id},[t._v(t._s(e.name))])})),a("li",[a("b-button",{attrs:{type:"is-info",size:"is-small","icon-left":"map-marker-alt"},on:{click:function(e){t.showAddLocation=!0}}},[t._v("Add Location")])],1)],2),a("b-modal",{attrs:{"has-modal-card":"","trap-focus":"","destroy-on-hide":!1,"aria-role":"dialog","aria-modal":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("LocationAdd",{on:{close:e.close,add:t.addLocation}})]}}],null,!1,2315125307),model:{value:t.showAddLocation,callback:function(e){t.showAddLocation=e},expression:"showAddLocation"}})],1)])])]),a("div",{staticClass:"column is-6"},[a("div",{staticClass:"card"},[t._m(4),a("div",{staticClass:"columns card-content"},[a("div",{staticClass:"column is-4"},[a("h2",{staticClass:"subtitle"},[t._v("Upon Arrival")]),t.campaign.bonuses.arriving?a("p",{staticClass:"content can-update",on:{click:function(e){return t.updateBonuses("arriving")}}},[t._v(t._s(t.campaign.bonuses.arriving))]):a("p",{staticClass:"can-update",on:{click:function(e){return t.updateBonuses("arriving")}}},[t._v("None")])]),a("div",{staticClass:"column is-4"},[a("h2",{staticClass:"subtitle"},[t._v("When Departing")]),t.campaign.bonuses.departing?a("p",{staticClass:"content can-update",on:{click:function(e){return t.updateBonuses("departing")}}},[t._v(t._s(t.campaign.bonuses.departing))]):a("p",{staticClass:"can-update",on:{click:function(e){return t.updateBonuses("departing")}}},[t._v("None")])]),a("div",{staticClass:"column is-4"},[a("h2",{staticClass:"subtitle"},[t._v("Other")]),t.campaign.bonuses.other?a("p",{staticClass:"content can-update",on:{click:function(e){return t.updateBonuses("other")}}},[t._v(t._s(t.campaign.bonuses.other))]):a("p",{staticClass:"can-update",on:{click:function(e){return t.updateBonuses("other")}}},[t._v("None")])])])])]),a("div",{staticClass:"column is-6"},[a("div",{staticClass:"card"},[t._m(5),a("div",{staticClass:"columns card-content"},t._l(["new_life","death","society","conviction"],(function(e){return a("div",{key:e,staticClass:"column is-3"},[a("h2",{staticClass:"title is-size-5"},[t._v(t._s(t.campaign.principles[e].name))]),a("hr"),t.campaign.principles[e].selected?a("h1",{staticClass:"is-size-5"},[t._v(" "+t._s(t.campaign.principles[e].selected)+" ")]):a("h1",{staticClass:"is-size-7"},[a("span",{staticClass:"can-update",on:{click:function(a){return t.selectPrinciple(e,t.campaign.principles[e].choices[0])}}},[t._v(t._s(t.campaign.principles[e].choices[0]))]),a("div",{staticClass:"divider"},[t._v("OR")]),a("span",{staticClass:"can-update",on:{click:function(a){return t.selectPrinciple(e,t.campaign.principles[e].choices[1])}}},[t._v(t._s(t.campaign.principles[e].choices[1]))])])])})),0)])]),a("div",{staticClass:"column is-12"},[a("div",{staticClass:"card"},[t._m(6),a("div",{staticClass:"columns card-content"},[a("div",{staticClass:"column is-5"},t._l(t.leftMilestones,(function(e,s){return a("div",{key:s,staticClass:"level"},[a("div",{staticClass:"level-left"},[a("div",{staticClass:"level-item"},[t._v(" "+t._s(e.trigger)+" ")])]),a("div",{staticClass:"level-right"},[a("div",{staticClass:"level-item"},[a("span",{staticClass:"bl-story-event",staticStyle:{"margin-right":".25em"}}),t._v(" "),a("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(e.consequence))])])])])})),0),t._m(7),a("div",{staticClass:"column is-5"},t._l(t.rightMilestones,(function(e,s){return a("div",{key:s,staticClass:"level"},[a("div",{staticClass:"level-left"},[a("div",{staticClass:"level-item"},[t._v(" "+t._s(e.trigger)+" ")])]),a("div",{staticClass:"level-right"},[a("div",{staticClass:"level-item"},[a("span",{staticClass:"bl-story-event",staticStyle:{"margin-right":".25em"}}),t._v(" "),a("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(e.consequence))])])])])})),0)])])])])]):t._e()},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"card-header"},[a("p",{staticClass:"card-header-title is-centered"},[t._v("Members")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"card-header"},[a("p",{staticClass:"card-header-title is-centered"},[t._v("Survival")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"card-header"},[a("p",{staticClass:"card-header-title is-centered"},[t._v("Quarries")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"card-header"},[a("p",{staticClass:"card-header-title is-centered"},[t._v("Locations")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"card-header"},[a("p",{staticClass:"card-header-title is-centered"},[t._v("Special Bonuses")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"card-header"},[a("p",{staticClass:"card-header-title is-centered"},[t._v("Principles")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"card-header"},[a("p",{staticClass:"card-header-title is-centered"},[t._v("Milestones")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"column is-2"},[a("div",{staticClass:"divider is-vertical content",staticStyle:{height:"100%"}})])}],n=(a("99af"),a("4de4"),a("7db0"),a("caad"),a("13d5"),a("b0c0"),a("ac1f"),a("2532"),a("1276"),a("5530")),c=a("2f62"),r=a("dc59"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Add Quarry")]),a("button",{staticClass:"delete",attrs:{type:"button"},on:{click:t.close}})]),a("section",{staticClass:"modal-card-body"},[a("p",{staticClass:"content"},[t._v(" Select a Quarry to add to your Settlement's hunt list. "),a("b-message",{attrs:{type:"is-warning"}},[t._v("This list contains all valid quarries.")])],1),a("b-field",{attrs:{label:"Quarry","label-position":"on-border"}},[a("b-select",{attrs:{placeholder:"Add Quarry",icon:"paw",required:"",expanded:""},model:{value:t.quarry,callback:function(e){t.quarry=e},expression:"quarry"}},t._l(t.validQuarries,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})),0)],1)],1),a("footer",{staticClass:"modal-card-foot"},[a("button",{staticClass:"button",attrs:{type:"button"},on:{click:t.close}},[t._v("Cancel")]),a("button",{staticClass:"button is-success",on:{click:t.select}},[t._v("Add Quarry")])])])},l=[],d={name:"AddQuarry",data:function(){return{quarry:null}},computed:Object(n["a"])(Object(n["a"])({},Object(c["c"])(["quarries"])),{},{validQuarries:function(){var t=this;return this.campaign&&this.quarries?this.quarries.filter((function(e){return!t.campaign.quarries.includes(e.id)})):[]}}),methods:{select:function(){var t=this.quarry;this.quarry=null,this.$emit("add",t)},close:function(){this.quarry=null,this.$emit("close")}}},u=d,v=a("0c7c"),p=Object(v["a"])(u,o,l,!1,null,null,null),h=p.exports,m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Add Location")]),a("button",{staticClass:"delete",attrs:{type:"button"},on:{click:t.close}})]),a("section",{staticClass:"modal-card-body"},[a("p",{staticClass:"content"},[t._v(" Select a Location to add to your Settlement's Locations list. "),a("b-message",{attrs:{type:"is-warning"}},[t._v("This list contains all valid locations available.")])],1),a("b-field",{attrs:{label:"Location","label-position":"on-border"}},[a("b-select",{attrs:{placeholder:"Add Location",icon:"location-arrow",required:"",expanded:""},model:{value:t.location,callback:function(e){t.location=e},expression:"location"}},t._l(t.validLocations,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})),0)],1)],1),a("footer",{staticClass:"modal-card-foot"},[a("button",{staticClass:"button",attrs:{type:"button"},on:{click:t.close}},[t._v("Cancel")]),a("button",{staticClass:"button is-success",on:{click:t.select}},[t._v("Add Location")])])])},f=[],b={name:"AddLocation",data:function(){return{location:null}},computed:Object(n["a"])(Object(n["a"])({},Object(c["c"])(["locations"])),{},{validLocations:function(){var t=this;return this.campaign&&this.locations?this.locations.filter((function(e){return!t.campaign.locations.includes(e.id)})):[]}}),methods:{select:function(){var t=this.location;this.location=null,this.$emit("add",t)},close:function(){this.location=null,this.$emit("close")}}},_=b,g=Object(v["a"])(_,m,f,!1,null,null,null),C=g.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Invite User")]),a("button",{staticClass:"delete",attrs:{type:"button"},on:{click:t.close}})]),a("section",{staticClass:"modal-card-body"},[a("p",{staticClass:"content"},[t._v(" Invite a user to your campaign. ")]),t._m(0),a("b-field",{attrs:{label:"User","label-position":"on-border",expanded:""}},[a("b-select",{attrs:{placeholder:"User",icon:"user-plus",required:"",expanded:""},model:{value:t.newUser,callback:function(e){t.newUser=e},expression:"newUser"}},t._l(t.validUsers,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.displayName))])})),0)],1)],1),a("footer",{staticClass:"modal-card-foot"},[a("button",{staticClass:"button",attrs:{type:"button"},on:{click:t.close}},[t._v("Cancel")]),a("button",{staticClass:"button is-success",on:{click:t.select}},[t._v("Invite User")])])])},w=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"note is-size-7 mb-3"},[t._v(" They must have signed up for your"),a("br"),t._v("Kingdom Death Management install already. ")])}],k={name:"AddUser",data:function(){return{newUser:null}},computed:Object(n["a"])(Object(n["a"])({},Object(c["c"])(["users"])),{},{validUsers:function(){var t=this;return this.users?this.users.filter((function(e){return!t.campaign.members.includes(e.id)})):[]}}),methods:{select:function(){var t=this.newUser;this.newUser=null,this.$emit("add",t)},close:function(){this.newUser=null,this.$emit("close")}}},A=k,L=Object(v["a"])(A,y,w,!1,null,null,null),x=L.exports,S={name:"Settlement",components:{QuarryAdd:h,LocationAdd:C,UserAdd:x},data:function(){return{showAddQuarry:!1,showAddLocation:!1,showAddUser:!1,showTitleEdit:!1}},computed:Object(n["a"])(Object(n["a"])({},Object(c["c"])(["user","innovations","innovated","users","quarries","locations"])),{},{leftMilestones:function(){return this.campaign.milestones.filter((function(t,e){return e%2}))},rightMilestones:function(){return this.campaign.milestones.filter((function(t,e){return!(e%2)}))},campaignQuarries:function(){var t=this;return this.quarries.filter((function(e){return t.campaign.quarries.includes(e.id)}))},campaignLocations:function(){var t=this;return this.locations.filter((function(e){return t.campaign.locations.includes(e.id)}))},members:function(){var t=this;return this.users.filter((function(e){return t.campaign.members.includes(e.id)}))},maxSurvivalBonus:function(){return this.researchedInnovations.filter((function(t){return t.increaseLimit})).length},departingSurvival:function(){return this.researchedInnovations.filter((function(t){return t.departingSurvival})).length},researchedInnovations:function(){var t=this;return this.innovations.filter((function(e){return t.innovated.find((function(t){return t.id===e.id&&t.innovated}))}))}}),methods:Object(n["a"])(Object(n["a"])({},Object(c["b"])(["setLoading","bindCampaign"])),{},{updateField:function(t,e){var a=this,s=t.split(".").reduce((function(t,e){return t[e]}),this.campaign);if(s!==e){this.setLoading(!0);var i={};i[t]=e,r["a"].collection("campaigns").doc(this.campaign.id).update(i).then((function(){return a.setLoading(!1)}))}},updateTitle:function(){var t=this;this.$buefy.dialog.prompt({message:"Change Settlement Name",trapFocus:!0,inputAttrs:{value:this.campaign.name},onConfirm:function(e){return t.updateField("name",e)}})},updateSurvival:function(){var t=this;this.$buefy.dialog.prompt({message:"Update Max Survival",trapFocus:!0,inputAttrs:{type:"number",value:this.campaign.survival.max},onConfirm:function(e){return t.updateField("survival.max",parseInt(e))}})},updateBonuses:function(t){var e=this;this.$buefy.dialog.prompt({message:"Update Bonuses (".concat(t,")"),trapFocus:!0,inputAttrs:{value:this.campaign.bonuses[t]},onConfirm:function(a){return e.updateField("bonuses.".concat(t),a)}})},addQuarry:function(t){var e=this;t&&0!==t.length&&(this.setLoading(!0),r["a"].collection("campaigns").doc(this.campaign.id).update({quarries:r["b"].firestore.FieldValue.arrayUnion(t)}).then((function(){e.setLoading(!1),e.showAddQuarry=!1})))},addLocation:function(t){var e=this;t&&0!==t.length&&(this.setLoading(!0),r["a"].collection("campaigns").doc(this.campaign.id).update({locations:r["b"].firestore.FieldValue.arrayUnion(t)}).then((function(){e.setLoading(!1),e.showAddLocation=!1})))},addUser:function(t){var e=this;t&&0!==t.length&&(this.setLoading(!0),r["a"].collection("campaigns").doc(this.campaign.id).update({members:r["b"].firestore.FieldValue.arrayUnion(t)}).then((function(){e.setLoading(!1),e.showAddUser=!1})))},selectPrinciple:function(t,e){var a=this,s=this.campaign.principles[t];this.$buefy.dialog.confirm({title:"Select Principle",message:'Confirm selecting <span class="has-text-weight-bold">'.concat(e,'</span> for the principle <span class="has-text-weight-bold">').concat(s.name,"</span>?"),type:"is-info",onConfirm:function(){return a.updateField("principles.".concat(t,".selected"),e)}})}})},U=S,$=(a("e555"),Object(v["a"])(U,s,i,!1,null,"08de38f5",null));e["default"]=$.exports}}]);
//# sourceMappingURL=settlement.a7c038d4.js.map